<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Data Manipulation in R</title>
  <meta name="description" content="Data Manipulation in R">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="Data Manipulation in R" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="altaf-ali/tidydata_tutorial" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Data Manipulation in R" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="getting-started.html">
<link rel="next" href="merging-datasets.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="css/readthedocs.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="acknowledgments.html"><a href="acknowledgments.html"><i class="fa fa-check"></i><b>2</b> Acknowledgments</a></li>
<li class="chapter" data-level="3" data-path="resources.html"><a href="resources.html"><i class="fa fa-check"></i><b>3</b> Resources</a></li>
<li class="chapter" data-level="4" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>4</b> Getting Started</a><ul>
<li class="chapter" data-level="4.1" data-path="getting-started.html"><a href="getting-started.html#prerequisites"><i class="fa fa-check"></i><b>4.1</b> Prerequisites</a></li>
<li class="chapter" data-level="4.2" data-path="getting-started.html"><a href="getting-started.html#software-requirements"><i class="fa fa-check"></i><b>4.2</b> Software Requirements</a><ul>
<li class="chapter" data-level="4.2.1" data-path="getting-started.html"><a href="getting-started.html#r-and-rstudio"><i class="fa fa-check"></i><b>4.2.1</b> R and RStudio</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="getting-started.html"><a href="getting-started.html#required-packages"><i class="fa fa-check"></i><b>4.3</b> Required Packages</a><ul>
<li class="chapter" data-level="4.3.1" data-path="getting-started.html"><a href="getting-started.html#option-1-use-tidyverse"><i class="fa fa-check"></i><b>4.3.1</b> Option 1: Use <code>tidyverse</code></a></li>
<li class="chapter" data-level="4.3.2" data-path="getting-started.html"><a href="getting-started.html#option-2-install-individual-packages"><i class="fa fa-check"></i><b>4.3.2</b> Option 2: Install Individual Packages</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="basic-operations.html"><a href="basic-operations.html"><i class="fa fa-check"></i><b>5</b> Basic Operations</a><ul>
<li class="chapter" data-level="5.1" data-path="basic-operations.html"><a href="basic-operations.html#data-pipelines"><i class="fa fa-check"></i><b>5.1</b> Data pipelines</a></li>
<li class="chapter" data-level="5.2" data-path="basic-operations.html"><a href="basic-operations.html#dataset"><i class="fa fa-check"></i><b>5.2</b> Dataset</a></li>
<li class="chapter" data-level="5.3" data-path="basic-operations.html"><a href="basic-operations.html#select"><i class="fa fa-check"></i><b>5.3</b> Select</a></li>
<li class="chapter" data-level="5.4" data-path="basic-operations.html"><a href="basic-operations.html#filter"><i class="fa fa-check"></i><b>5.4</b> Filter</a><ul>
<li class="chapter" data-level="5.4.1" data-path="basic-operations.html"><a href="basic-operations.html#exercise"><i class="fa fa-check"></i><b>5.4.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="basic-operations.html"><a href="basic-operations.html#arrange"><i class="fa fa-check"></i><b>5.5</b> Arrange</a><ul>
<li class="chapter" data-level="5.5.1" data-path="basic-operations.html"><a href="basic-operations.html#exercise-1"><i class="fa fa-check"></i><b>5.5.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="basic-operations.html"><a href="basic-operations.html#mutate"><i class="fa fa-check"></i><b>5.6</b> Mutate</a><ul>
<li class="chapter" data-level="5.6.1" data-path="basic-operations.html"><a href="basic-operations.html#exercise-2"><i class="fa fa-check"></i><b>5.6.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="basic-operations.html"><a href="basic-operations.html#summarise"><i class="fa fa-check"></i><b>5.7</b> Summarise</a><ul>
<li class="chapter" data-level="5.7.1" data-path="basic-operations.html"><a href="basic-operations.html#exercise-3"><i class="fa fa-check"></i><b>5.7.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="basic-operations.html"><a href="basic-operations.html#unite"><i class="fa fa-check"></i><b>5.8</b> Unite</a></li>
<li class="chapter" data-level="5.9" data-path="basic-operations.html"><a href="basic-operations.html#separate"><i class="fa fa-check"></i><b>5.9</b> Separate</a><ul>
<li class="chapter" data-level="5.9.1" data-path="basic-operations.html"><a href="basic-operations.html#exercise-4"><i class="fa fa-check"></i><b>5.9.1</b> Exercise</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="merging-datasets.html"><a href="merging-datasets.html"><i class="fa fa-check"></i><b>6</b> Merging Datasets</a><ul>
<li class="chapter" data-level="6.1" data-path="merging-datasets.html"><a href="merging-datasets.html#left-join"><i class="fa fa-check"></i><b>6.1</b> Left Join</a></li>
<li class="chapter" data-level="6.2" data-path="merging-datasets.html"><a href="merging-datasets.html#right-join"><i class="fa fa-check"></i><b>6.2</b> Right Join</a></li>
<li class="chapter" data-level="6.3" data-path="merging-datasets.html"><a href="merging-datasets.html#inner-join"><i class="fa fa-check"></i><b>6.3</b> Inner Join</a></li>
<li class="chapter" data-level="6.4" data-path="merging-datasets.html"><a href="merging-datasets.html#full-join"><i class="fa fa-check"></i><b>6.4</b> Full Join</a></li>
<li class="chapter" data-level="6.5" data-path="merging-datasets.html"><a href="merging-datasets.html#different-column-names"><i class="fa fa-check"></i><b>6.5</b> Different Column Names</a></li>
<li class="chapter" data-level="6.6" data-path="merging-datasets.html"><a href="merging-datasets.html#exercise-5"><i class="fa fa-check"></i><b>6.6</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="reshaping.html"><a href="reshaping.html"><i class="fa fa-check"></i><b>7</b> Reshaping</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Manipulation in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="basic-operations" class="section level1">
<h1><span class="header-section-number">5</span> Basic Operations</h1>
<p>Let’s start off by creating a new R script and loading <code>tidyverse</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)</code></pre></div>
<p>Clear everything to make sure there’s nothing leftover in our environment</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</code></pre></div>
<div id="data-pipelines" class="section level2">
<h2><span class="header-section-number">5.1</span> Data pipelines</h2>
<p>Dplyr makes it easy to “chain” functions together using the <em>pipe</em> operator <code>%&gt;%</code>. The following diagram illustrates the general concept of pipes where data flows from one pipe to another until all the processing is completed.</p>
<div class="figure">
<img src="img/pipes.png" alt="" />

</div>
<p>The syntax of the pipe operator <code>%&gt;%</code> might appear unusual at first, but once you get used to it you’ll start to appreciate its power and flexibility.</p>
</div>
<div id="dataset" class="section level2">
<h2><span class="header-section-number">5.2</span> Dataset</h2>
<p>We’re using a dataset of flight departures from Houston in 2011.</p>
<table>
<thead>
<tr class="header">
<th align="left">Filename</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">flights.csv</td>
<td align="left">Flight departures from Houston in 2011</td>
</tr>
<tr class="even">
<td align="left">weather.csv</td>
<td align="left">Hourly weather</td>
</tr>
<tr class="odd">
<td align="left">planes.csv</td>
<td align="left">Metadata for planes</td>
</tr>
<tr class="even">
<td align="left">airports.csv</td>
<td align="left">Metadata for airports</td>
</tr>
</tbody>
</table>
<p>We’re going to use the <code>readr</code> package which provides improved functions for reading datasets from files. Instead of the usual <code>read.csv()</code> function, we’ll use the <code>read_csv()</code> function from <code>readr</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">flights &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/altaf-ali/tidydata_tutorial/master/data/flights.csv&quot;</span>)
weather &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/altaf-ali/tidydata_tutorial/master/data/weather.csv&quot;</span>)
planes &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/altaf-ali/tidydata_tutorial/master/data/planes.csv&quot;</span>)
airports &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/altaf-ali/tidydata_tutorial/master/data/airports.csv&quot;</span>)</code></pre></div>
<p>Now let’s examine the dataset</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">flights</code></pre></div>
<pre><code># A tibble: 227,496 x 14
                  date  hour minute   dep   arr dep_delay arr_delay
                &lt;dttm&gt; &lt;int&gt;  &lt;int&gt; &lt;int&gt; &lt;int&gt;     &lt;int&gt;     &lt;int&gt;
 1 2011-01-01 12:00:00    14      0  1400  1500         0       -10
 2 2011-01-02 12:00:00    14      1  1401  1501         1        -9
 3 2011-01-03 12:00:00    13     52  1352  1502        -8        -8
 4 2011-01-04 12:00:00    14      3  1403  1513         3         3
 5 2011-01-05 12:00:00    14      5  1405  1507         5        -3
 6 2011-01-06 12:00:00    13     59  1359  1503        -1        -7
 7 2011-01-07 12:00:00    13     59  1359  1509        -1        -1
 8 2011-01-08 12:00:00    13     55  1355  1454        -5       -16
 9 2011-01-09 12:00:00    14     43  1443  1554        43        44
10 2011-01-10 12:00:00    14     43  1443  1553        43        43
# ... with 227,486 more rows, and 7 more variables: carrier &lt;chr&gt;,
#   flight &lt;int&gt;, dest &lt;chr&gt;, plane &lt;chr&gt;, cancelled &lt;int&gt;, time &lt;int&gt;,
#   dist &lt;int&gt;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">weather</code></pre></div>
<pre><code># A tibble: 8,723 x 14
         date  hour  temp dew_point humidity pressure visibility wind_dir
       &lt;date&gt; &lt;int&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;int&gt;    &lt;dbl&gt;      &lt;dbl&gt;    &lt;chr&gt;
 1 2011-01-01     0  59.0      28.9       32    29.86         10      NNE
 2 2011-01-01     1  57.2      28.4       33    29.88         10      NNE
 3 2011-01-01     2  55.4      28.4       36    29.93         10      NNW
 4 2011-01-01     3  53.6      28.4       38    29.94         10    North
 5 2011-01-01     4    NA        NA       NA    29.99         10      NNW
 6 2011-01-01     5    NA        NA       NA    30.02         10    North
 7 2011-01-01     6  53.1      17.1       24    30.05         10    North
 8 2011-01-01     7  53.1      16.0       23    30.07         10    North
 9 2011-01-01     8  54.0      18.0       24    30.09         10    North
10 2011-01-01     9  55.4      17.6       23    30.09         10      NNE
# ... with 8,713 more rows, and 6 more variables: wind_dir2 &lt;int&gt;,
#   wind_speed &lt;dbl&gt;, gust_speed &lt;dbl&gt;, precip &lt;dbl&gt;, conditions &lt;chr&gt;,
#   events &lt;chr&gt;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">planes</code></pre></div>
<pre><code># A tibble: 2,853 x 9
    plane  year               mfr          model no.eng no.seats speed
    &lt;chr&gt; &lt;int&gt;             &lt;chr&gt;          &lt;chr&gt;  &lt;int&gt;    &lt;int&gt; &lt;int&gt;
 1 N576AA  1991 MCDONNELL DOUGLAS DC-9-82(MD-82)      2      172    NA
 2 N557AA  1993        MARZ BARRY      KITFOX IV      1        2    NA
 3 N403AA  1974             RAVEN           S55A     NA        1    60
 4 N492AA  1989 MCDONNELL DOUGLAS DC-9-82(MD-82)      2      172    NA
 5 N262AA  1985 MCDONNELL DOUGLAS DC-9-82(MD-82)      2      172    NA
 6 N493AA  1989 MCDONNELL DOUGLAS DC-9-82(MD-82)      2      172    NA
 7 N477AA  1988 MCDONNELL DOUGLAS DC-9-82(MD-82)      2      172    NA
 8 N476AA  1988 MCDONNELL DOUGLAS DC-9-82(MD-82)      2      172    NA
 9 N504AA    NA AUTHIER ANTHONY P      TIERRA II      1        2    NA
10 N565AA  1987 MCDONNELL DOUGLAS DC-9-83(MD-83)      2      172    NA
# ... with 2,843 more rows, and 2 more variables: engine &lt;chr&gt;, type &lt;chr&gt;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">airports</code></pre></div>
<pre><code># A tibble: 3,376 x 7
    iata              airport             city state country      lat
   &lt;chr&gt;                &lt;chr&gt;            &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;    &lt;dbl&gt;
 1   00M              Thigpen      Bay Springs    MS     USA 31.95376
 2   00R Livingston Municipal       Livingston    TX     USA 30.68586
 3   00V          Meadow Lake Colorado Springs    CO     USA 38.94575
 4   01G         Perry-Warsaw            Perry    NY     USA 42.74135
 5   01J     Hilliard Airpark         Hilliard    FL     USA 30.68801
 6   01M    Tishomingo County          Belmont    MS     USA 34.49167
 7   02A           Gragg-Wade          Clanton    AL     USA 32.85049
 8   02C              Capitol       Brookfield    WI     USA 43.08751
 9   02G    Columbiana County   East Liverpool    OH     USA 40.67331
10   03D     Memphis Memorial          Memphis    MO     USA 40.44726
# ... with 3,366 more rows, and 1 more variables: long &lt;dbl&gt;</code></pre>
<p>Notice that because we used <code>read_csv()</code>, the data frame we received now prints nicely without having to use the <code>head()</code> function and does not clutter your screen.</p>
</div>
<div id="select" class="section level2">
<h2><span class="header-section-number">5.3</span> Select</h2>
<p>The <code>select</code> function is used to select columns.</p>
<ul>
<li>Select the destination, duration and distance columns (<code>dest</code>, <code>time</code> and <code>dist</code>)</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">flights %&gt;%
<span class="st">  </span><span class="kw">select</span>(dest, time, dist)</code></pre></div>
<pre><code># A tibble: 227,496 x 3
    dest  time  dist
   &lt;chr&gt; &lt;int&gt; &lt;int&gt;
 1   DFW    40   224
 2   DFW    45   224
 3   DFW    48   224
 4   DFW    39   224
 5   DFW    44   224
 6   DFW    45   224
 7   DFW    43   224
 8   DFW    40   224
 9   DFW    41   224
10   DFW    45   224
# ... with 227,486 more rows</code></pre>
<p>Add the arrival delay (<code>arr_delay</code>) and departure delay (<code>dep_delay</code>) columns as well.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">flights %&gt;%
<span class="st">  </span><span class="kw">select</span>(dest, time, dist, arr_delay, dep_delay)</code></pre></div>
<pre><code># A tibble: 227,496 x 5
    dest  time  dist arr_delay dep_delay
   &lt;chr&gt; &lt;int&gt; &lt;int&gt;     &lt;int&gt;     &lt;int&gt;
 1   DFW    40   224       -10         0
 2   DFW    45   224        -9         1
 3   DFW    48   224        -8        -8
 4   DFW    39   224         3         3
 5   DFW    44   224        -3         5
 6   DFW    45   224        -7        -1
 7   DFW    43   224        -1        -1
 8   DFW    40   224       -16        -5
 9   DFW    41   224        44        43
10   DFW    45   224        43        43
# ... with 227,486 more rows</code></pre>
<p>Other ways to do the same</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">flights %&gt;%
<span class="st">  </span><span class="kw">select</span>(dest, time, dist, <span class="kw">ends_with</span>(<span class="st">&quot;delay&quot;</span>))</code></pre></div>
<pre><code># A tibble: 227,496 x 5
    dest  time  dist dep_delay arr_delay
   &lt;chr&gt; &lt;int&gt; &lt;int&gt;     &lt;int&gt;     &lt;int&gt;
 1   DFW    40   224         0       -10
 2   DFW    45   224         1        -9
 3   DFW    48   224        -8        -8
 4   DFW    39   224         3         3
 5   DFW    44   224         5        -3
 6   DFW    45   224        -1        -7
 7   DFW    43   224        -1        -1
 8   DFW    40   224        -5       -16
 9   DFW    41   224        43        44
10   DFW    45   224        43        43
# ... with 227,486 more rows</code></pre>
<p>and …</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">flights %&gt;%
<span class="st">  </span><span class="kw">select</span>(dest, time, dist, <span class="kw">contains</span>(<span class="st">&quot;delay&quot;</span>))</code></pre></div>
<pre><code># A tibble: 227,496 x 5
    dest  time  dist dep_delay arr_delay
   &lt;chr&gt; &lt;int&gt; &lt;int&gt;     &lt;int&gt;     &lt;int&gt;
 1   DFW    40   224         0       -10
 2   DFW    45   224         1        -9
 3   DFW    48   224        -8        -8
 4   DFW    39   224         3         3
 5   DFW    44   224         5        -3
 6   DFW    45   224        -1        -7
 7   DFW    43   224        -1        -1
 8   DFW    40   224        -5       -16
 9   DFW    41   224        43        44
10   DFW    45   224        43        43
# ... with 227,486 more rows</code></pre>
<p>Select all columns from <code>date</code> to <code>arr</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">flights %&gt;%
<span class="st">  </span><span class="kw">select</span>(date:arr)</code></pre></div>
<pre><code># A tibble: 227,496 x 5
                  date  hour minute   dep   arr
                &lt;dttm&gt; &lt;int&gt;  &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1 2011-01-01 12:00:00    14      0  1400  1500
 2 2011-01-02 12:00:00    14      1  1401  1501
 3 2011-01-03 12:00:00    13     52  1352  1502
 4 2011-01-04 12:00:00    14      3  1403  1513
 5 2011-01-05 12:00:00    14      5  1405  1507
 6 2011-01-06 12:00:00    13     59  1359  1503
 7 2011-01-07 12:00:00    13     59  1359  1509
 8 2011-01-08 12:00:00    13     55  1355  1454
 9 2011-01-09 12:00:00    14     43  1443  1554
10 2011-01-10 12:00:00    14     43  1443  1553
# ... with 227,486 more rows</code></pre>
<p>Select all <em>except</em> <code>plane</code> column using the <em>minus</em> sign</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">flights %&gt;%
<span class="st">  </span><span class="kw">select</span>(-plane)</code></pre></div>
<pre><code># A tibble: 227,496 x 13
                  date  hour minute   dep   arr dep_delay arr_delay
                &lt;dttm&gt; &lt;int&gt;  &lt;int&gt; &lt;int&gt; &lt;int&gt;     &lt;int&gt;     &lt;int&gt;
 1 2011-01-01 12:00:00    14      0  1400  1500         0       -10
 2 2011-01-02 12:00:00    14      1  1401  1501         1        -9
 3 2011-01-03 12:00:00    13     52  1352  1502        -8        -8
 4 2011-01-04 12:00:00    14      3  1403  1513         3         3
 5 2011-01-05 12:00:00    14      5  1405  1507         5        -3
 6 2011-01-06 12:00:00    13     59  1359  1503        -1        -7
 7 2011-01-07 12:00:00    13     59  1359  1509        -1        -1
 8 2011-01-08 12:00:00    13     55  1355  1454        -5       -16
 9 2011-01-09 12:00:00    14     43  1443  1554        43        44
10 2011-01-10 12:00:00    14     43  1443  1553        43        43
# ... with 227,486 more rows, and 6 more variables: carrier &lt;chr&gt;,
#   flight &lt;int&gt;, dest &lt;chr&gt;, cancelled &lt;int&gt;, time &lt;int&gt;, dist &lt;int&gt;</code></pre>
</div>
<div id="filter" class="section level2">
<h2><span class="header-section-number">5.4</span> Filter</h2>
<p>The <code>filter()</code> function returns rows with matching conditions. We can find all flights to Boston (BOS) like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">flights %&gt;%
<span class="st">  </span><span class="kw">filter</span>(dest ==<span class="st"> &quot;BOS&quot;</span>)</code></pre></div>
<pre><code># A tibble: 1,752 x 14
                  date  hour minute   dep   arr dep_delay arr_delay
                &lt;dttm&gt; &lt;int&gt;  &lt;int&gt; &lt;int&gt; &lt;int&gt;     &lt;int&gt;     &lt;int&gt;
 1 2011-01-31 12:00:00     7     35   735  1220         0         4
 2 2011-01-31 12:00:00    10     47  1047  1526        -3        -5
 3 2011-01-31 12:00:00    13      5  1305  1746         0        -3
 4 2011-01-31 12:00:00    19      1  1901  2332         6        -1
 5 2011-01-31 12:00:00    15     50  1550  2012         0       -25
 6 2011-01-30 12:00:00    10     46  1046  1518        -4        -8
 7 2011-01-30 12:00:00    13     19  1319  1811        14        22
 8 2011-01-30 12:00:00    19      9  1909    23        14        50
 9 2011-01-30 12:00:00    15     53  1553  2030         3        -7
10 2011-01-29 12:00:00     7     40   740  1227         5        16
# ... with 1,742 more rows, and 7 more variables: carrier &lt;chr&gt;,
#   flight &lt;int&gt;, dest &lt;chr&gt;, plane &lt;chr&gt;, cancelled &lt;int&gt;, time &lt;int&gt;,
#   dist &lt;int&gt;</code></pre>
<p>Let’s build on the previous exercise and find all flights to Boston (BOS) and select only the <code>dest</code>, <code>time</code>, <code>dist</code> columns:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">flights %&gt;%
<span class="st">  </span><span class="kw">select</span>(dest, time, dist) %&gt;%
<span class="st">  </span><span class="kw">filter</span>(dest ==<span class="st"> &quot;BOS&quot;</span>)</code></pre></div>
<pre><code># A tibble: 1,752 x 3
    dest  time  dist
   &lt;chr&gt; &lt;int&gt; &lt;int&gt;
 1   BOS   195  1597
 2   BOS   188  1597
 3   BOS   190  1597
 4   BOS   188  1597
 5   BOS   180  1597
 6   BOS   190  1597
 7   BOS   185  1597
 8   BOS   198  1597
 9   BOS   194  1597
10   BOS   203  1597
# ... with 1,742 more rows</code></pre>
<p>Now let’s do the filter first and then select the columns</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">flights %&gt;%
<span class="st">  </span><span class="kw">filter</span>(dest ==<span class="st"> &quot;BOS&quot;</span>) %&gt;%
<span class="st">  </span><span class="kw">select</span>(dest, time, dist) </code></pre></div>
<pre><code># A tibble: 1,752 x 3
    dest  time  dist
   &lt;chr&gt; &lt;int&gt; &lt;int&gt;
 1   BOS   195  1597
 2   BOS   188  1597
 3   BOS   190  1597
 4   BOS   188  1597
 5   BOS   180  1597
 6   BOS   190  1597
 7   BOS   185  1597
 8   BOS   198  1597
 9   BOS   194  1597
10   BOS   203  1597
# ... with 1,742 more rows</code></pre>
<p>In this case the order doesn’t matter, but when using pipes make sure you understand that each function is executed in sequence and the results are then fed to the next one.</p>
<div id="exercise" class="section level3">
<h3><span class="header-section-number">5.4.1</span> Exercise</h3>
<p>Find all flights that match the following conditions:</p>
<ol style="list-style-type: decimal">
<li>To SFO or OAK</li>
<li>In January</li>
<li>Delayed by more than an hour</li>
<li>Departed between midnight and 5am</li>
<li>Arrival delay more than twice the departure delay</li>
</ol>
<p>Here’s a brief summary of operators you can use:</p>
<p><strong>Comparison Operators</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">Operator</th>
<th align="left">Description</th>
<th align="left">Example (assume x is 5)</th>
<th align="left">Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">&gt;</td>
<td align="left">greater than</td>
<td align="left">x &gt; 5</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">&gt;=</td>
<td align="left">greater than or equal to</td>
<td align="left">x &gt;= 5</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">&lt;</td>
<td align="left">less than</td>
<td align="left">x &lt; 5</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">&lt;=</td>
<td align="left">less than or equal to</td>
<td align="left">x &lt;= 5</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">==</td>
<td align="left">equal to</td>
<td align="left">x == 5</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">!=</td>
<td align="left">not equal to</td>
<td align="left">x != 5</td>
<td align="left">FALSE</td>
</tr>
</tbody>
</table>
<p><strong>Logical Operators</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">Operator</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">!</td>
<td align="left">not</td>
</tr>
<tr class="even">
<td align="left">|</td>
<td align="left">or</td>
</tr>
<tr class="odd">
<td align="left">&amp;</td>
<td align="left">and</td>
</tr>
</tbody>
</table>
<p><strong>Other Operators</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">Operator</th>
<th align="left">Description</th>
<th align="left">Example (assume x is 5)</th>
<th align="left">Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">%in%</td>
<td align="left">check element in a vector</td>
<td align="left">x %in% c(1, 3, 5, 7)<br>x %in% c(2, 4, 6, 8)</td>
<td align="left">TRUE<br>FALSE</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="arrange" class="section level2">
<h2><span class="header-section-number">5.5</span> Arrange</h2>
<p>The <code>arrange()</code> function is used to sort the rows based on one or more columns</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">flights %&gt;%
<span class="st">  </span><span class="kw">arrange</span>(dest)</code></pre></div>
<pre><code># A tibble: 227,496 x 14
                  date  hour minute   dep   arr dep_delay arr_delay
                &lt;dttm&gt; &lt;int&gt;  &lt;int&gt; &lt;int&gt; &lt;int&gt;     &lt;int&gt;     &lt;int&gt;
 1 2011-01-31 12:00:00    17     33  1733  1901        -2        -4
 2 2011-01-30 12:00:00    17     50  1750  1913        15         8
 3 2011-01-29 12:00:00    17     32  1732  1837        -3       -23
 4 2011-01-28 12:00:00    17     33  1733  1848        -2       -17
 5 2011-01-27 12:00:00    17     41  1741  1854         6       -11
 6 2011-01-26 12:00:00    17     32  1732  1853        -3       -12
 7 2011-01-25 12:00:00    17     29  1729  1858        -6        -7
 8 2011-01-24 12:00:00    17     34  1734  1845        -1       -20
 9 2011-01-23 12:00:00    17     35  1735  1853         0       -12
10 2011-01-22 12:00:00    17     33  1733  1843        -2       -17
# ... with 227,486 more rows, and 7 more variables: carrier &lt;chr&gt;,
#   flight &lt;int&gt;, dest &lt;chr&gt;, plane &lt;chr&gt;, cancelled &lt;int&gt;, time &lt;int&gt;,
#   dist &lt;int&gt;</code></pre>
<div id="exercise-1" class="section level3">
<h3><span class="header-section-number">5.5.1</span> Exercise</h3>
<ol style="list-style-type: decimal">
<li>Order flights by departure date and time</li>
<li>Which flights were most delayed?</li>
<li>Which flights caught up the most time during flight?</li>
</ol>
</div>
</div>
<div id="mutate" class="section level2">
<h2><span class="header-section-number">5.6</span> Mutate</h2>
<p>The <code>mutate()</code> function is used to create new variables.</p>
<p>Up until now we’ve only been examining the dataset but haven’t made any changes to it. All our functions so far have simply displayed the results on screen but haven’t created or modified existing variables. Let’s see how we can create a new variable called <code>speed</code> based on the distance and duration in the flights dataframe.</p>
<p>In this exercise we’re adding a new variable to an existing dataframe so we’ll just overwrite the <code>flights</code> variable with the one that has a <code>speed</code> column</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">flights &lt;-<span class="st"> </span>flights %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">speed =</span> dist /<span class="st"> </span>(time /<span class="st"> </span><span class="dv">60</span>))</code></pre></div>
<div id="exercise-2" class="section level3">
<h3><span class="header-section-number">5.6.1</span> Exercise</h3>
<ol style="list-style-type: decimal">
<li>Add a variable to show how much time was made up (or lost) during flight</li>
</ol>
</div>
</div>
<div id="summarise" class="section level2">
<h2><span class="header-section-number">5.7</span> Summarise</h2>
<p>Let’s count the number of flights departing each day.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">flights %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(date) %&gt;%
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">count =</span> <span class="kw">n</span>()) </code></pre></div>
<pre><code># A tibble: 365 x 2
                  date count
                &lt;dttm&gt; &lt;int&gt;
 1 2011-01-01 12:00:00   552
 2 2011-01-02 12:00:00   678
 3 2011-01-03 12:00:00   702
 4 2011-01-04 12:00:00   583
 5 2011-01-05 12:00:00   590
 6 2011-01-06 12:00:00   660
 7 2011-01-07 12:00:00   661
 8 2011-01-08 12:00:00   500
 9 2011-01-09 12:00:00   602
10 2011-01-10 12:00:00   659
# ... with 355 more rows</code></pre>
<p>Here’s a nice little trick. You can use <code>View()</code> to look at the results of a pipe operation without creating new variables.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">flights %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(date) %&gt;%
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">count =</span> <span class="kw">n</span>()) %&gt;%
<span class="st">  </span><span class="kw">View</span>()</code></pre></div>
<p>Of course, often times we’d want to save the summary in a variable for further analysis.</p>
<p>Let’s find the average departure delay for each destination</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">delays &lt;-<span class="st"> </span>flights %&gt;%
<span class="st">    </span><span class="kw">group_by</span>(dest) %&gt;%
<span class="st">    </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(dep_delay))

delays</code></pre></div>
<pre><code># A tibble: 116 x 2
    dest   mean
   &lt;chr&gt;  &lt;dbl&gt;
 1   ABQ     NA
 2   AEX     NA
 3   AGS 10.000
 4   AMA     NA
 5   ANC 24.952
 6   ASE     NA
 7   ATL     NA
 8   AUS     NA
 9   AVL     NA
10   BFL     NA
# ... with 106 more rows</code></pre>
<div id="exercise-3" class="section level3">
<h3><span class="header-section-number">5.7.1</span> Exercise</h3>
<ol style="list-style-type: decimal">
<li>What’s wrong with the results above, and how would you fix the problem?</li>
<li>Can you think of using filter to solve the problem?</li>
<li>Use help to find out two other ways to do summarize/n combination in dplyr.</li>
<li>How many different destinations can you fly to from Houston?</li>
<li>Which destinations have the highest average delays?</li>
<li>Which flights (carrier + flight number) happen everyday and where do they fly?</li>
<li>How do delays (of non-cancelled flights) vary over the course of a day?</li>
</ol>
</div>
</div>
<div id="unite" class="section level2">
<h2><span class="header-section-number">5.8</span> Unite</h2>
<p>The <code>unite</code> function is useful for combining multiple columns together. In the example below, we join the <code>carrier</code> and <code>flight</code> to create a unique <code>flight_id</code> column.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">flights %&gt;%
<span class="st">  </span><span class="kw">unite</span>(flight_id, carrier, flight, <span class="dt">sep =</span> <span class="st">&quot;-&quot;</span>, <span class="dt">remove =</span> <span class="ot">FALSE</span>) %&gt;%
<span class="st">  </span><span class="kw">select</span>(date, carrier, flight, flight_id)</code></pre></div>
<pre><code># A tibble: 227,496 x 4
                  date carrier flight flight_id
 *              &lt;dttm&gt;   &lt;chr&gt;  &lt;int&gt;     &lt;chr&gt;
 1 2011-01-01 12:00:00      AA    428    AA-428
 2 2011-01-02 12:00:00      AA    428    AA-428
 3 2011-01-03 12:00:00      AA    428    AA-428
 4 2011-01-04 12:00:00      AA    428    AA-428
 5 2011-01-05 12:00:00      AA    428    AA-428
 6 2011-01-06 12:00:00      AA    428    AA-428
 7 2011-01-07 12:00:00      AA    428    AA-428
 8 2011-01-08 12:00:00      AA    428    AA-428
 9 2011-01-09 12:00:00      AA    428    AA-428
10 2011-01-10 12:00:00      AA    428    AA-428
# ... with 227,486 more rows</code></pre>
</div>
<div id="separate" class="section level2">
<h2><span class="header-section-number">5.9</span> Separate</h2>
<p>The <code>separate</code> function works the other way around by splitting a single column into multiple columns. Let’s split the <code>date</code> column into separate <code>date</code> and <code>time</code> columns.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">flights %&gt;%
<span class="st">  </span><span class="kw">separate</span>(date, <span class="kw">c</span>(<span class="st">&quot;date&quot;</span>, <span class="st">&quot;time&quot;</span>), <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>)</code></pre></div>
<pre><code># A tibble: 227,496 x 16
         date     time  hour minute   dep   arr dep_delay arr_delay
 *      &lt;chr&gt;    &lt;chr&gt; &lt;int&gt;  &lt;int&gt; &lt;int&gt; &lt;int&gt;     &lt;int&gt;     &lt;int&gt;
 1 2011-01-01 12:00:00    14      0  1400  1500         0       -10
 2 2011-01-02 12:00:00    14      1  1401  1501         1        -9
 3 2011-01-03 12:00:00    13     52  1352  1502        -8        -8
 4 2011-01-04 12:00:00    14      3  1403  1513         3         3
 5 2011-01-05 12:00:00    14      5  1405  1507         5        -3
 6 2011-01-06 12:00:00    13     59  1359  1503        -1        -7
 7 2011-01-07 12:00:00    13     59  1359  1509        -1        -1
 8 2011-01-08 12:00:00    13     55  1355  1454        -5       -16
 9 2011-01-09 12:00:00    14     43  1443  1554        43        44
10 2011-01-10 12:00:00    14     43  1443  1553        43        43
# ... with 227,486 more rows, and 8 more variables: carrier &lt;chr&gt;,
#   flight &lt;int&gt;, dest &lt;chr&gt;, plane &lt;chr&gt;, cancelled &lt;int&gt;, time &lt;int&gt;,
#   dist &lt;int&gt;, speed &lt;dbl&gt;</code></pre>
<div id="exercise-4" class="section level3">
<h3><span class="header-section-number">5.9.1</span> Exercise</h3>
<ol style="list-style-type: decimal">
<li>Split the <code>date</code> column into <code>year</code>, <code>month</code>, and <code>day</code> columns</li>
<li>Ensure that the <code>year</code>, <code>month</code>, and <code>day</code> columns are of type <em>integer</em> (NOT <em>character</em>)
<ul>
<li>HINT: Use online help for <code>separate</code> for an easy way to do this</li>
</ul></li>
</ol>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="getting-started.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="merging-datasets.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": {}
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["tidydata_tutorial.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
